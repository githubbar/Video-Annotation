from Ui_window import Ui_MainWindow
from PyQt4.QtGui import *
from PyQt4.QtCore import *
import os, csv, threading
import random

class VisualizeWidget:
    def visClicked(self):
        from heatmap import HeatMap        
        paletteFile='palettes/classic.png'
        W = int(self.graphicsView.scene.width())
        H = int(self.graphicsView.scene.height())
        heatmapBox=[0,  W,  0,  H]
        box=[0, 1, 0, 1]
        radius = 13
        hp = []
        for n in range(self.items.rowCount()):
            if self.items.item(n, 0).checkState() == Qt.Checked:
                item = self.items.item(n, 0).g
                for p in item.polygon:
                    hp += [(p.x(), p.y())]
                    
        hm = HeatMap(heatmapBox[0], heatmapBox[1], heatmapBox[2],  heatmapBox[3],  paletteFile)
        hm.add_points(hp, radius) 
        hm.transform_color(0.3)
        p = QPixmap.fromImage(QImage(hm.get_image_buffer(), hm.width,  hm.height,  QImage.Format_ARGB32))
        self.graphicsView.scene.heatmap = self.graphicsView.scene.addPixmap(p)
