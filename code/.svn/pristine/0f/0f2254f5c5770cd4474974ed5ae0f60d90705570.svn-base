# -*- coding: utf-8 -*-
""" Help browser panel """

from PyQt4.QtGui import *
from PyQt4.QtCore import *
from PyQt4.QtWebKit import *
import PyQt4.QtNetwork

#class HelpBrowser(QTextBrowser):
#    def __init__(self, helpEngine, parent=None):    
#        QTextBrowser.__init__(self, parent)
#        self.helpEngine = helpEngine
#        
#    def loadResource(self, type, url):
#        if (url.scheme() == "qthelp"):
#            return QVariant(self.helpEngine.fileData(url))
#        else:
#            return QTextBrowser.loadResource(type, url)


class HelpBrowser(QWebView):
    def __init__(self, helpEngine, parent=None):    
        QWebView.__init__(self, parent)
        self.helpEngine = helpEngine
#        QWebSettings.globalSettings().setAttribute(QWebSettings.AutoLoadImages, True)
#        QWebSettings.globalSettings().setAttribute(QWebSettings.LocalContentCanAccessRemoteUrls, True)
#        QWebSettings.globalSettings().setAttribute(QWebSettings.DeveloperExtrasEnabled, True)
#        QWebSettings.globalSettings().setAttribute(QWebSettings.PluginsEnabled, True)

    def load(self, url):
        import os
        if (url.scheme() == "qthelp"):
#            self.setContent(self.helpEngine.fileData(url), QString(), QUrl(u'qthelp://cil.com.va.38/help'))
#            inspector = QWebInspector(self)
#            inspector.setPage(self.page())
#            inspector.setFixedSize(self.width(), 200)
#            inspector.setVisible(True)      
            path = QFileInfo(self.helpEngine.collectionFile()).path()
            fileName = QFileInfo(url.toString()).fileName()
            url = QUrl.fromLocalFile( os.path.join(str(path), str(fileName)))
        QWebView.load(self, url)
        
